# 3.7 分层存储架构 (Tiered Storage Architecture)

为解决海量超高清数字资源（TB/PB 级）的“存储成本”与“访问性能”之间的矛盾，系统采用冷热分层存储策略。

## 1. 存储分层策略表

| 存储层级 | 定义与定位 | 适用数据类型 | 性能要求 | 存储介质示例 | 成本特征 |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **在线存储 (Hot / Online)** | **高频访问层**<br>支撑实时浏览、检索与 IIIF 图像服务。 | - IIIF切片 (Pyramid TIFF)<br>- 视频流媒体 (H.264/HLS)<br>- 3D模型 (GLB/USDZ)<br>- 缩略图/预览图<br>- 索引数据库 | **低延迟**<br>IOPS > 10,000<br>响应 < 200ms | - 企业级 SSD 阵列<br>- 高性能对象存储 (S3 Standard) | 高 |
| **近线存储 (Warm / Nearline)** | **低频访问层**<br>支撑非实时的下载申请、编辑调取与数据交换。 | - 原始采集文件 (RAW/CR2)<br>- 无损母带 (ProRes 422)<br>- 高精度点云 (PLY/OBJ)<br>- 中间过程稿 | **高吞吐**<br>顺序读写 > 500MB/s<br>响应 < 1min | - 大容量 HDD 阵列 (RAID 6)<br>- 低频对象存储 (S3 Infrequent Access) | 中 |
| **离线存储 (Cold / Offline)** | **归档保存层**<br>支撑长期保存、灾备恢复与合规审计（仅管理员可触达）。 | - AIP 保存包 (含 METS/PREMIS)<br>- 历史版本数据<br>- 数据库全量备份 | **极高可靠性**<br>数据持久性 99.999999999%<br>响应 > 1h (需回取) | - LTO 磁带库<br>- 蓝光光盘库<br>- 归档云存储 (S3 Glacier Deep Archive) | 低 |

## 2. 数据迁移与生命周期管理 (ILM)

### 2.1 自动迁移规则
- **热转冷**：
  - 规则：当资源的“最后访问时间”超过 [365] 天，且未被标记为“常设展览”或“重点藏品”时。
  - 动作：将 Nearline 层数据迁移至 Offline 层，释放 Nearline 空间。
  - 注意：Hot 层数据（缩略图/元数据）始终保留，确保检索可见。

- **冷回热 (Recall)**：
  - 触发：管理员发起“高清数据提取”或“格式重制”任务。
  - 动作：从磁带库/归档云调取 AIP，解包至 Nearline 临时区，任务完成后保留 [7] 天自动清除。

### 2.2 存储冗余与校验
- **多副本策略**：
  - Hot 层：双副本或纠删码 (Erasure Coding) 保护。
  - Warm/Cold 层：建议遵循 **3-2-1 备份原则**（3份拷贝、2种介质、1份异地）。
- **Fixity 校验**：
  - 周期：每 [6] 个月对 Cold 层数据进行一次抽样/全量 SHA-256 校验。
  - 异常处理：发现校验失败（Bit Rot）时，自动从副本恢复并报警。

## 3. 存储容量规划建议 (示例)

> *注：需根据实际藏品量测算*

- **年增量预估**：50TB (影像) + 20TB (视频) + 10TB (三维) = 80TB/年
- **5年总容量**：约 400TB (原始) + 120TB (衍生) = 520TB
- **建议配比**：
  - Hot: 15% (~80TB)
  - Warm: 25% (~130TB)
  - Cold: 60% (~310TB)
